Traceback (most recent call last):
  File "/home/runner/.cache/pypoetry/virtualenvs/ccs-oj5MS1KF-py3.9/lib/python3.9/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/runner/.cache/pypoetry/virtualenvs/ccs-oj5MS1KF-py3.9/lib/python3.9/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/runner/.cache/pypoetry/virtualenvs/ccs-oj5MS1KF-py3.9/lib/python3.9/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/home/runner/.cache/pypoetry/virtualenvs/ccs-oj5MS1KF-py3.9/lib/python3.9/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/asyncio/base_events.py", line 647, in run_until_complete
    return future.result()
  File "/home/runner/.cache/pypoetry/virtualenvs/ccs-oj5MS1KF-py3.9/lib/python3.9/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/home/runner/.cache/pypoetry/virtualenvs/ccs-oj5MS1KF-py3.9/lib/python3.9/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/runner/.cache/pypoetry/virtualenvs/ccs-oj5MS1KF-py3.9/lib/python3.9/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
#DEFINE INPUT

input={
    "General": {
        "interface": "CCS"
    },
    "Twobody": {
                "Xx-Xx": {
                        "Rcut": 6.0,
                        "Resolution": 0.05,
                        "Swtype": "rep"
                }
        }
}
#SAVE TO FILE
with open('input.json', 'w') as f:
    json.dump(input, f, indent=8)
    
#RUN FIT
ccs_fit("input.json")
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mValueError[0m                                Traceback (most recent call last)
Cell [0;32mIn [4], line 20[0m
[1;32m     17[0m     json[38;5;241m.[39mdump([38;5;28minput[39m, f, indent[38;5;241m=[39m[38;5;241m8[39m)
[1;32m     19[0m [38;5;66;03m#RUN FIT[39;00m
[0;32m---> 20[0m [43mccs_fit[49m[43m([49m[38;5;124;43m"[39;49m[38;5;124;43minput.json[39;49m[38;5;124;43m"[39;49m[43m)[49m

File [0;32m~/work/CCS/CCS/src/ccs/fitting/main.py:361[0m, in [0;36mtwp_fit[0;34m(filename)[0m
[1;32m    349[0m nn [38;5;241m=[39m Objective(
[1;32m    350[0m     atom_pairs,
[1;32m    351[0m     atom_onebodies,
[0;32m   (...)[0m
[1;32m    357[0m     ewald_forces[38;5;241m=[39mewald_forces,
[1;32m    358[0m )
[1;32m    360[0m [38;5;66;03m# Solve QP problem[39;00m
[0;32m--> 361[0m predicted_energies, mse, xx_unfolded [38;5;241m=[39m [43mnn[49m[38;5;241;43m.[39;49m[43msolution[49m[43m([49m[43m)[49m

File [0;32m~/work/CCS/CCS/src/ccs/fitting/objective.py:119[0m, in [0;36mObjective.solution[0;34m(self)[0m
[1;32m    113[0m [38;5;124;03m"""Function to solve the objective with constraints."""[39;00m
[1;32m    115[0m [38;5;66;03m# COMMENTS MERGING THE INTERVALS[39;00m
[1;32m    116[0m [38;5;66;03m# self.merge_intervals()[39;00m
[1;32m    117[0m 
[1;32m    118[0m [38;5;66;03m# Reduce stoichiometry[39;00m
[0;32m--> 119[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mreduce_stoichiometry[49m[43m([49m[43m)[49m
[1;32m    121[0m [38;5;28mself[39m[38;5;241m.[39mmm [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mget_m()
[1;32m    122[0m logger[38;5;241m.[39mdebug([38;5;124m"[39m[38;5;130;01m\n[39;00m[38;5;124m Shape of M matrix is : [39m[38;5;132;01m%s[39;00m[38;5;124m"[39m, [38;5;28mself[39m[38;5;241m.[39mmm[38;5;241m.[39mshape)

File [0;32m~/work/CCS/CCS/src/ccs/fitting/objective.py:107[0m, in [0;36mObjective.reduce_stoichiometry[0;34m(self)[0m
[1;32m    104[0m     [38;5;28;01mif[39;00m check [38;5;241m==[39m [38;5;241m0[39m:
[1;32m    105[0m         reduce [38;5;241m=[39m [38;5;28;01mFalse[39;00m
[0;32m--> 107[0m [38;5;28;01massert[39;00m [38;5;28mself[39m[38;5;241m.[39msto[38;5;241m.[39mshape[[38;5;241m1[39m] [38;5;241m==[39m [43mnp[49m[38;5;241;43m.[39;49m[43mlinalg[49m[38;5;241;43m.[39;49m[43mmatrix_rank[49m[43m([49m
[1;32m    108[0m [43m    [49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msto[49m
[1;32m    109[0m [43m[49m[43m)[49m, [38;5;124m"[39m[38;5;124mLinear dependence in stochiometry matrix[39m[38;5;124m"[39m
[1;32m    110[0m [38;5;28mself[39m[38;5;241m.[39mcols_sto [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39msto[38;5;241m.[39mshape[[38;5;241m1[39m]

File [0;32m<__array_function__ internals>:180[0m, in [0;36mmatrix_rank[0;34m(*args, **kwargs)[0m

File [0;32m~/.cache/pypoetry/virtualenvs/ccs-oj5MS1KF-py3.9/lib/python3.9/site-packages/numpy/linalg/linalg.py:1900[0m, in [0;36mmatrix_rank[0;34m(A, tol, hermitian)[0m
[1;32m   1898[0m S [38;5;241m=[39m svd(A, compute_uv[38;5;241m=[39m[38;5;28;01mFalse[39;00m, hermitian[38;5;241m=[39mhermitian)
[1;32m   1899[0m [38;5;28;01mif[39;00m tol [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[0;32m-> 1900[0m     tol [38;5;241m=[39m [43mS[49m[38;5;241;43m.[39;49m[43mmax[49m[43m([49m[43maxis[49m[38;5;241;43m=[39;49m[38;5;241;43m-[39;49m[38;5;241;43m1[39;49m[43m,[49m[43m [49m[43mkeepdims[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m)[49m [38;5;241m*[39m [38;5;28mmax[39m(A[38;5;241m.[39mshape[[38;5;241m-[39m[38;5;241m2[39m:]) [38;5;241m*[39m finfo(S[38;5;241m.[39mdtype)[38;5;241m.[39meps
[1;32m   1901[0m [38;5;28;01melse[39;00m:
[1;32m   1902[0m     tol [38;5;241m=[39m asarray(tol)[[38;5;241m.[39m[38;5;241m.[39m[38;5;241m.[39m, newaxis]

File [0;32m~/.cache/pypoetry/virtualenvs/ccs-oj5MS1KF-py3.9/lib/python3.9/site-packages/numpy/core/_methods.py:40[0m, in [0;36m_amax[0;34m(a, axis, out, keepdims, initial, where)[0m
[1;32m     38[0m [38;5;28;01mdef[39;00m [38;5;21m_amax[39m(a, axis[38;5;241m=[39m[38;5;28;01mNone[39;00m, out[38;5;241m=[39m[38;5;28;01mNone[39;00m, keepdims[38;5;241m=[39m[38;5;28;01mFalse[39;00m,
[1;32m     39[0m           initial[38;5;241m=[39m_NoValue, where[38;5;241m=[39m[38;5;28;01mTrue[39;00m):
[0;32m---> 40[0m     [38;5;28;01mreturn[39;00m [43mumr_maximum[49m[43m([49m[43ma[49m[43m,[49m[43m [49m[43maxis[49m[43m,[49m[43m [49m[38;5;28;43;01mNone[39;49;00m[43m,[49m[43m [49m[43mout[49m[43m,[49m[43m [49m[43mkeepdims[49m[43m,[49m[43m [49m[43minitial[49m[43m,[49m[43m [49m[43mwhere[49m[43m)[49m

[0;31mValueError[0m: zero-size array to reduction operation maximum which has no identity
ValueError: zero-size array to reduction operation maximum which has no identity

